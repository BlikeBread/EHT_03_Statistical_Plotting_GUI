# µEHT NovoHeart CTScreen Processing Pipeline (Script 03/03)

This repository contains an R script for interactive statistical analysis and plotting of µEHT measurement outputs generated using the NovoHeart CTScreen platform.

This script represents the third step (03/03) of a modular µEHT analysis pipeline.

The pipeline takes the merged multi-donor dataset generated in Script 02 and provides an interactive GUI environment for donor selection, grouping, week comparison, statistical testing, and automated figure generation.

---

## What the pipeline does

Starting from the Step 02 merged CSV file (`Merged_AllDonors_step001_plus_FollowingYes.csv`), the script:

- Loads the merged multi-donor dataset  
- Allows interactive donor selection  
- Allows optional merging of donors into custom groups (e.g., Control and Patient)  
- Allows selection of specific metrics to plot (with possibility to skip metrics)  
- Allows selection of pacing frequencies (Hz)  
- Allows selection of week(s) to analyze (e.g., Week1, Week2, Week1_vs_Week2)  
- Automatically skips plotting when fewer than two groups are available  
- Performs statistical testing where applicable  
- Generates publication-ready bar plots (mean ± SEM)  
- Exports all figures in a structured folder hierarchy  

---

## Required inputs

### 1. Step 02 Merged Dataset

Input file must be:

`Merged_AllDonors_step001_plus_FollowingYes.csv`

This file must be generated by Script 02 (Step 02) of this pipeline.

Minimum required columns:

- Donor  
- Week_Time  
- Hz  
- Metric columns to analyze  
- Plot_Group (if defined previously; otherwise inferred)

The file is selected interactively via GUI dialog.

---

## Cleaned summary outputs

The script generates:

- Week-specific plot folders (e.g., `Week_1`, `Week_2`)  
- Week comparison folders (e.g., `Week_1_vs_Week_2`)  
- A_Plots (all donors separately)  
- Grouped_AllDonors plots (all donors in one graph with side-by-side week bars)  
- B_Control_vs_Patient plots (only if exactly two merged groups exist)  

Folders are only created if corresponding plots are generated.

---

## Typical use cases

- Multi-donor µEHT statistical analysis  
- Baseline vs paced comparisons across donors  
- Week-to-week maturation comparisons  
- Control vs Patient phenotype comparisons  
- Generation of publication-ready figures  
- Rapid exploratory analysis for collaborative projects  

---

## Position in the µEHT Pipeline

This script is Script 03 of a 3-step µEHT analysis workflow:

- Script 01 – CTScreen parsing, expected pacing mapping, and “Following” classification  
- Script 02 – Donor merge + baseline retention + Following-only filtering  
- Script 03 (this repository) – Metadata selection, statistical analysis, and visualization  

---

## Methods Description

µEHT measurements generated using the NovoHeart CTScreen platform were processed using a custom R pipeline. In Step 03, the merged multi-donor dataset was interactively filtered to select donors, metrics, pacing frequencies, and weeks of interest. Donors could be analyzed individually or merged into experimental groups. Statistical testing and automated figure generation were performed to produce publication-ready visualizations.

---

## Authorship

This script was developed by **Michele Buono** and can be used freely for research purposes, provided appropriate citation of the author. 

**Buono, M. F. (2026). µEHT Analysis Pipeline (Script 03/03) – Statistical Analysis & Automated Visualization (v.1.0.1). Zenodo. https://doi.org/10.5281/zenodo.18682470**

The overall workflow, structure, and clarity of the pipeline were iteratively refined with assistance from **OpenAI - ChatGPT 5.2**, which was used as a tool to improve code organization, documentation, and usability.
